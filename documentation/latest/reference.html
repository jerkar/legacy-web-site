<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>reference</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Java build tool">
    <meta name="author" content="Jerome Angibaud">
    <meta name="keywords" content="build,java,tool,automation,maven,ant,gradle,buildr,sbt,make,compiler,tester,jacoco">
    <meta name="generator" content="JBake">

    <!-- Le styles -->
    <link href="../../css/bootstrap.css" rel="stylesheet">
    <!-- <link href="../../css/bootstrap.min.css" rel="stylesheet">  -->
    <link href="../../css/asciidoctor.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link href="../../css/prettify.css" rel="stylesheet">
    <link href="../../css/jerkar.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
      
    <![endif]-->
    
      <!-- Fav and touch icons -->
    <!--<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">-->
    <link rel="shortcut icon" href="../../favicon.ico">
  
  	<!-- highlight.js -->
  	<script src="../../js/highlight.pack.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>
	<link rel="stylesheet" href="../../css/highlight-idea.css">
	
	<!-- sidebar css -->
	<link href="../../css/sidebar.css" rel="stylesheet">
  
  </head>
  <body onload="prettyPrint()">
    <div id="wrap">

	<!-- Fixed navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand">
          	<img style="max-width:32px;margin-top: -7px;" src="../../img/logo.png">
          </a>
          <a class="navbar-brand">Jerkar</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="../../index.html">Home</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">Documentation<b class="caret"></b></a>
              <ul class="dropdown-menu">
                <li><a href="../../documentation/latest/getting-started.html">Tutorial</a></li>
                <li><a href="../../documentation/latest/reference.html">Reference Guide</a></li>
                <li><a href="../../javadoc/latest/index.html">Javadoc</a></li>
              </ul>
            </li>
            <li><a href="../../about.html">About</a></li>
          </ul>
        </div>
       
        
      </div>
    </div>
    <div class="container">
	<p>
	<div id="sidebar-menu" class="col-md-3 hidden-xs hidden-sm">
    <ul class="main-menu nav nav-stacked affix">
        <li><a href="javascript:jerkarMoveTo('Introduction',2);">Introduction</a></li>
        <li class="liexpandable"><a href="javascript:jerkarMoveTo('Build Configuration',2);">Build Configuration</a>
          <ul class="sub-menu">
            <li><a href="javascript:jerkarMoveTo('Environment variables',3);">Environment variables</a></li>
            <li><a href="javascript:jerkarMoveTo('System properties',3);">System properties</a></li>
            <li class="liexpandable"><a href="javascript:jerkarMoveTo('Jerkar options',3);">Jerkar options</a>
              <ul class="sub-menu">
                <li><a href="javascript:jerkarMoveTo('Standars options',4);">Standars options</a></li>
                <li><a href="javascript:jerkarMoveTo('How to retrieve Jerkar options ?',4);">How to retrieve Jerkar options ?</a></li>
                <li><a href="javascript:jerkarMoveTo('Composite options',4);">Composite options</a></li>
                <li><a href="javascript:jerkarMoveTo('How to document option ?',4);">How to document option ?</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li class="liexpandable"><a href="javascript:jerkarMoveTo('Dependency Management',2);">Dependency Management</a>
          <ul class="sub-menu">
            <li><a href="javascript:jerkarMoveTo('What is a dependency ?',3);">What is a dependency ?</a></li>
            <li><a href="javascript:jerkarMoveTo('What is a scope ?',3);">What is a scope ?</a></li>
            <li class="liexpandable"><a href="javascript:jerkarMoveTo('Define dependencies for a project',3);">Define dependencies for a project</a>
              <ul class="sub-menu">
                <li><a href="javascript:jerkarMoveTo('Define scopes',4);">Define scopes</a></li>
                <li class="liexpandable"><a href="javascript:jerkarMoveTo('Defining individual dependency',4);">Defining individual dependency</a>
                  <ul class="sub-menu">
                    <li><a href="javascript:jerkarMoveTo('File system dependencies',5);">File system dependencies</a></li>
                    <li><a href="javascript:jerkarMoveTo('Project dependencies',5);">Project dependencies</a></li>
                  </ul>
                </li>
                <li><a href="javascript:jerkarMoveTo('Bind dependencies to scope',4);">Bind dependencies to scope</a></li>
              </ul>
            </li>
          </ul>
        </li>
    </ul>
</div>
<script>
function jerkarMoveTo(title, level) {
    var elemType = 'h'+level;
    var elems = $(elemType);
    var elem;
    for (var i = 0; i < elems.length; i++) {
    	var candidate = elems[i];
    	if (candidate.outerText ===  title) {
    		elem = candidate;
    		break;
    	}
    }
    $('html, body').animate({
        scrollTop: $(elem).offset().top -50
    }, 200);
}
</script><p><div id="static-content" class="col-md-9"></p><h2>Introduction</h2>
<hr/><p>This document stands for reference guide. You'll find here details on Jerkar behaviour. </p>
<ul>
  <li><p>If you need an overall vision of Jerkar, please have a <a href="http://jerkar.github.io/tour.html"><strong>tour</strong></a>.</p></li>
  <li><p>If you need a a step-by-step learning guide, please visit <a href="http://jerkar.github.io/documentation/latest/getting-started.html"><strong>tutorial</strong></a>.</p></li>
  <li><p>If you need more details about the API or in-deep behavior, please consult <a href="http://jerkar.github.io/javadoc/latest/index.html"><strong>javadoc</strong></a> or browse <a href="https://github.com/jerkar/jerkar/tree/master/org.jerkar.core"><strong>source code</strong></a>. You can also raise an issue in Git-hub to request an improvement on the documentation.</p></li>
</ul><p><br/></p><h2>Build Configuration</h2>
<hr/><p>Jerkar builds are configurable, in the sense that any value required to run the build has not to be hard-coded<br/>in the build script. Instead a value can be injected by 3 different ways :</p>
<ul>
  <li>as a environment variable</li>
  <li>as a system property</li>
  <li>as a Jerkar option</li>
</ul><h3>Environment variables</h3><p>There is nothing specific to Jerkar. Just set the environment variable as you usually do on your OS and get the value from build using the standard Java <code>System#getenv</code> method.</p><h3>System properties</h3><p>Jerkar proposes 3 ways to inject system properties :</p>
<ul>
  <li>By setting the property/value in the <code>system.properties</code> file located in the <code>[Jerkar Home]</code> directory.<br/> Note that if you are running Jerkar in embedded mode, the <code>[Jerkar Home]/system.properties</code> file will not be taken in account but [project dir/build/def/build/system.properties].</li>
  <li>By setting the property/value in the <code>system.properties</code> file located in the <code>[Jerkar User Home]</code> directory. The Jerkar user home is mentioned at the beginning of all Jerkar process.</li>
  <li>By mentioning the property/value in the Jerkar command line as `Jerkar doDefault -DmyProperty=myValue</li>
</ul><p>The command line takes precedence on the <code>[Jerkar User Home]/system.properties</code> that takes precedence, in turn, on the [Jerkar Home]/system.properties.</p><p>To read system properties from your builds, you can just use the standard method <code>System#getProperty</code>.</p><h3>Jerkar options</h3><p>Jerkar options are similar to system properties as it stands for a set of key/values. Jerkar proposes 3 ways to inject Jerkar properties :</p>
<ul>
  <li>By setting the property/value in the <code>options.properties</code> file located in the <code>[Jerkar Home]</code> directory.<br/> Note that if you are running Jerkar in embedded mode, the <code>[Jerkar Home]/options.properties</code> file will not be taken in account but [project dir/build/def/build/options.properties].</li>
  <li>By setting the property/value in the options.properties file located in the <code>[Jerkar User Home]</code> directory. The Jerkar user home is mentioned at the beginning of all Jerkar process.</li>
  <li>By mentioning the property/value in the Jerkar command line as `Jerkar doDefault -myOption=myValue</li>
</ul><p>As for system properties, The command line takes precedence on the <code>[Jerkar User Home]/options.properties</code> that takes precedence, in turn, on the [Jerkar Home]/options.properties.</p><p>Note for boolean, when no value is specified, <code>true</code> will be used as default.</p><h4>Standars options</h4><p>Jerkar predefines some standard options that you can set for any build :</p>
<ul>
  <li>buildClass : This forces the build class to use. If this option is not null then Jerkar will used the specified class as the build class.<br/>Note that this can be a simple class as <code>MyBuildClass</code> is enough for running <code>org.my.project.MyBuildClass</code>.</li>
  <li>verbose : when <code>true</code> Jerkar will be more verbose at logging at the price of being slower and bloating logs. Default value is <code>false</code>.</li>
  <li>silent : when <code>true</code>nothing will be logged. Default is <code>false</code></li>
</ul><h4>How to retrieve Jerkar options ?</h4><p>You can retrieve string values using the <code>JkOptions</code> API providing convenient static methods as <code>JkOptions#get</code>, <code>JkOptions#asMap</code> or <code>JkOptions#getAllStartingWith(String prefix)</code>.</p><p>You can also retrieve an option just by declaring a field in the build class having the same name as the option.<br/>For example, if you declare a field like <code>protected int size = 3;</code> then you can override the default value by injecting the option value in any of the 3 way described above.</p><p>Any field except static fields or private fields can be used to inject options.<br/>If you want inject option in a private field, you must annotate is with @JkDoc as <code>@JkDoc private boolean myField;</code> </p><p>Note that the string value that you have injected will be automatically converted to the target type.<br/>Handled types are String, all primitive types (and their wrappers), enum, File and composite object.</p><p>To get a precise idea on how types are converted see <a href="https://github.com/jerkar/jerkar/blob/master/org.jerkar.core/src/main/java/org/jerkar/OptionInjector.java">this code</a>.</p><h4>Composite options</h4><p>Composite options are a way to structure your options. Say that you want to configure some server access with url, userName and passwsord,<br/>you can gather all these information in a object as </p>
<pre><code class="Java">class Server {
	private String url;
	private String userName;
	private String password;
	// ...
}
</code></pre><p>declare a Server field in your build :</p>
<pre><code class="Java">class MyBuild extends JkBuild {
	Server deployServer;
	...
}
</code></pre><p>Then you can inject the server object using following options :<br/>deployServer.url=http://myServer:8090/to<br/>deployServer.username=myUsername<br/>deployServer.password=myPassword</p><h4>How to document option ?</h4><p>If you want your option been displayed when invoking <code>jerkar help</code> you need to annotate it with <code>@JkDoc</code>.</p><p>For example :<br/><code>Java
@JkDoc(&quot;Make the test run in a forked process&quot;)
private boolean forkTests = false;
</code></p><p><br/></p><h2>Dependency Management</h2>
<hr/><p>May the project you are building is standalone : you won't need any library or file coming from other project to build it. In that case you are not concerned with dependency management so you can skip this section.</p><p>If your project relies on libraries or files coming from other projects then <strong>dependency management</strong> comes in play.</p><h3>What is a dependency ?</h3><p>In this context, we call a <em>dependency</em> an indication that can be translated to a set of files needed to accomplish certain part of the build. In Jerkar code, the dependency concept is embodied by the abstract <code>JkDependency</code> class.<br/>So for example if a project <em>Foo</em> has a <em>dependency</em> on <em>barDep</em>, this means that for building, <em>Foo</em> will need the files indicated by <em>barDep</em>. </p><p>Jerkar distinguishes 3 types of dependency :</p>
<ul>
  <li><strong>Arbitrary files</strong> located on the file system (Embodied by <code>JkFileSystemDependency</code> class). These files are assumed to be present on the file system when the build is running.</li>
  <li><strong>Files produced by other projects</strong> (Embodied by <code>JkProjectDependency</code> class). These files may be present on file system or not. If they are not present, the external project is built in order to produce the missing files.</li>
  <li><strong>Reference to libraries</strong> (Embodied by <code>JkExternalModuleDependency</code>) hosted in a binary repository (Ivy or Maven for instance) : Jerkar can consume and resolve transitively any artifact located in a repository as you would do with Maven or Ivy.</li>
</ul>
<p class="alert alert-success">
For the last, Jerkar is using <b>Ivy 2.4.0</b> under the hood. The library is embedded in the Jerkar jar itself and is executed in a dedicated classloader to make the presence of Ivy invisible when you edit code so Ivy classes won't bloat your build path.
</p><h3>What is a scope ?</h3><p>Projects may need dependencies to accomplish certain tasks and needed dependencies may vary according the executed tasks.<br/>For example, to <strong>compile</strong> you may need <em>guava</em> library only but to <strong>test</strong> you'll need <em>junit</em> library as well.<br/>To segregate dependencies according their usage, Jerkar uses the notion of <strong>scope</strong> (embodied by <code>JkScope</code> class). This notion is similar to the Maven scope.</p><p>Scopes can inherit from each other. This means that if a <em>scope A</em> inherits from <em>scope B</em> then a dependencies declared with <em>scope B</em> will be also considered as declared with <em>scope A</em>.<br/>For example, in <code>JkJavaBuild</code> scope <code>TEST</code> inherits from <code>RUNTIME</code> that inherits from <code>COMPILE</code> so every dependencies declared with scope <code>COMPILE</code> are considered to be declared with scope <code>RUNTIME</code> and <code>TEST</code> as well. </p><p>By default, scopes are <em>transitive</em>. This has only a meaning for <strong>Reference to libraries</strong>.<br/>If <code>A</code> -&gt; <code>B</code> -&gt; <code>C</code> and the <code>A</code>-&gt; <code>B</code> dependency is declared with a non transitive scope, then <code>A</code> won't depend from <code>C</code>. </p><p>Projects consuming artifacts coming from Ivy repository can also use <code>JkScopeMapping</code> which is more powerfull. This notion maps strictly to the <a href="http://ant.apache.org/ivy/history/2.2.0/ivyfile/configurations.html">Ivy configuration</a> concept.</p><h3>Define dependencies for a project</h3><p>To define dependencies of a project, you basically define a list of <strong>scoped dependency</strong> (embodied by <code>JkScopedDependency</code>).<br/>A scoped dependency is a <strong>dependency</strong> associated with one or several <strong>scopes</strong>.</p><p>So practically, you define some scopes then you bind <em>dependencies</em> to these scopes.</p>
<pre><code class="Java">return JkDependencies.builder()
			.on(GUAVA, &quot;18.0&quot;).scope(COMPILE)  
			.on(JERSEY_SERVER, &quot;1.19&quot;).scope(COMPILE)
			.on(&quot;com.orientechnologies:orientdb-client:2.0.8&quot;).scope(COMPILE)
			.on(JUNIT, &quot;4.11&quot;).scope(TEST)
			.on(MOCKITO_ALL, &quot;1.9.5&quot;).scope(TEST)
		.build();
</code></pre><p>You can also omit the scope and set it later...</p>
<pre><code class="Java">JkDependencies deps = JkDependencies.builder()
			.on(GUAVA, &quot;18.0&quot;)
			.on(JERSEY_SERVER, &quot;1.19&quot;)
			.on(&quot;com.orientechnologies:orientdb-client:2.0.8&quot;)
			.on(JUNIT, &quot;4.11&quot;).scope(TEST)
			.on(MOCKITO_ALL, &quot;1.9.5&quot;).scope(TEST)
		.build();
...
deps = deps.withDefaultScope(COMPILE):
</code></pre><p>Look at the <a href="http://jerkar.github.io/javadoc/latest/org/jerkar/api/depmanagement/JkDependencies.html">JkDepencies class API</a> to get see all possibilities.</p><h4>Define scopes</h4><p>In the examples above, we use the predefined scopes <code>COMPILE</code> or <code>TEST</code>. These scopes are standard scopes defined on the <a href="https://github.com/jerkar/jerkar/blob/master/org.jerkar.core/src/main/java/org/jerkar/tool/builtins/javabuild/JkJavaBuild.java">JkJavaBuild class</a>.<br/>So if your build definition class inherit from <code>JkJavaBuild</code> template you won't need to create it. </p><p>A good practice is to declare <strong>scope</strong> as java constant (<code>static final</code>) as it will be reusable anywhere all over your build definition.</p><p>As an example, these are the scopes declared in <code>JkJavaBuild</code> :</p>
<pre><code class="Java">public static final JkScope PROVIDED = JkScope.of(&quot;provided&quot;).transitive(false)
    .descr(&quot;Dependencies to compile the project but that should not be embedded in produced artifacts.&quot;);

public static final JkScope COMPILE = JkScope.of(&quot;compile&quot;)
    .descr(&quot;Dependencies to compile the project.&quot;);

public static final JkScope RUNTIME = JkScope.of(&quot;runtime&quot;).extending(COMPILE)
	.descr(&quot;Dependencies to embed in produced artifacts (as war or fat jar files).&quot;);

public static final JkScope TEST = JkScope.of(&quot;test&quot;).extending(RUNTIME, PROVIDED)
	.descr(&quot;Dependencies necessary to compile and run tests.&quot;); 
</code></pre><h4>Defining individual dependency</h4><p>Now get focus on each type of dependency we can declare.</p><h5>File system dependencies</h5><h5>Project dependencies</h5><p>This stands for files produced by other project builds. It is typically used in multi-projects (aka multi-module projects).</p><p>The principle is that if the specified file are not found, then the dependee project is built in order to generate the missing files.<br/>You can create a <strong>project dependency</strong> from a Jerkar build defined in another project .<code>doDefault</code> method will be invoked on that build to generate missing files.</p>
<pre><code>	@JkProject(&quot;../foo&quot;)          // The external project path relative to the current project root
	public JkJavaBuild fooBuild;  // This is the build coming from the &#39;foo&#39; project 
	
	@Override
	protected JkDependencies dependencies() {
		return JkDependencies.builder()
			.on(fooBuild.asProjectDependency( fooBuid.packer().jarFile() ))
		.build();
	}
</code></pre><p>If the <code>fooBuild.packer().jarFile()</code> is absent then the <em>foo</em> project will be built by invoking the <code>doDefault</code> method.</p><p>You can also use another kind of project mentioning the command line to run in order to build the project, as such you can easily integrate with Maven, Grunt, SBT, Ant, Gradle projects.</p>
<pre><code> 	File fooDir = new File(&quot;../../foo&quot;);  // base dir of a Ant project 
	File fooJar = new File(fooDir, &quot;build/foo.jar&quot;);
	JkProcess antBuid = JkProcess.of(&quot;ant&quot;, &quot;makeJar&quot;).withWorkingDir(fooDir));
	...
	@Override
	protected JkDependencies dependencies() {
		return JkDependencies.builder()
			.on(JkProjectDependency.of(antBuild, fooJar))).scope(PROVIDED)  
		.build();
	}
</code></pre><p>This defines a dependency on a file produced by a Ant project. If the file is not present at dependency resolution time, then<br/>the Ant project is built to produce the missing files. </p><h4>Bind dependencies to scope</h4><p>The whole project dependency description lie in a single instance of <code>JkDependencies</code>. This class offers convenient factory methods and builder to define the dependencies.</p><p>```</p><p>```</p><p><br/></p><p></div> <!--end of wrapper div --> </p>
	</p>

	<hr />

		</div>
		<div id="push"></div>
    </div>
    
    <div id="footer">
      <div class="container">
        <p class="muted credit">&copy; 2014 | Mixed with <a href="http://getbootstrap.com/">Bootstrap v3.1.1</a> | Baked with <a href="http://jbake.org">JBake v2.3.2</a></p>
      </div>
    </div>
    
   
    
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="../../js/jquery-1.11.1.min.js"></script>
    <script src="../../js/bootstrap.min.js"></script>
    <script src="../../js/prettify.js"></script>
 	<script>
 	    lastSelect = null;
    	$('.liexpandable').click(function(evt) {
    		var li = $(evt.target).parents("li").first();
    		var ul = li.find(".sub-menu").first();
    		console.log(ul.is(':visible'));
    		evt.stopPropagation();
    		if (ul.is(':visible') && li.html() !== lastSelect) {
    			lastSelect = li.html();
    			return;
    		}
    		lastSelect = li.html();
      		ul.toggle();
 		});
    </script>
    
  </body>
</html>